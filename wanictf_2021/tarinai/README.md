# baby_heap
## 概要
名前を入力するプログラム。  
起動時にユーザーが入力したバッファの先頭のアドレスがもらえる。  
checksecで確認してみるとstackが実行可能かつcanaryなしなのでBoFでシェルコードを実行できそうな雰囲気がある。  
## 解法
動作を見てみると、2byte分だけBoFができる。  
2byteのみなので何もできなさそうに思えるが、main関数まで処理を追ってみると、leave時にRSPレジスタの下位2byteを書き換えれている事が確認できる。  
これによってleaveの次のret命令でRIPレジスタに渡されるアドレスを操作できる為、起動時に貰えるバッファの先頭アドレスに飛ばしてスタック上のシェルコードを動かす。