# stegorop
## 概要
文字を入力するとbrainfxckのようなコードを返してくれる。  
自明なBoFが存在し、PIEもなくcanaryもないのでROPが組めるのだが、グローバル変数lockによってmain関数の二回実行が塞がれているので、libc_baseをリークさせて二回目のROPを組むという定番の解法では解けないようになっている。   
## 解法(没?)
ROPが組めてしまうのでlockを書き換えてmain関数を書き換えようと企む。  
具体的には  
```c
read(0. *lock, 1);
```

を組むことでdataセクションに存在するlockを書き換えようとしたが、rdxを確定で0 > rdxにできるgadgetが見つからなかった。  
祈りながらexploitを実行したがrdxが0だったので何も書き込まれなかった...  
調べて見たところ、当時同じ方法で解けた方がいらっしゃったので、本番だったらこれで通ったんだと思う。  
恐らく環境の問題と思われるが、そもそもこれは非想定解らしいので、想定解の概要だけ調べて再挑戦してみる。  