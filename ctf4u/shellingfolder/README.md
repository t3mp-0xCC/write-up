# shellingfolder  
```https://github.com/ret2libc/ctfs/tree/master/hitcon2016quals/shellingfolder```
## 概要  
mallocを使用したファイルシステムモドキを実装している。    
## 解法  
フォルダ内のファイルのサイズを計算させる処理をする時に、ファイルおよびフォルダの名前で4バイトのオーバーフローができる。  
これによってサイズ用のポインタを上書きする事ができるので、任意のアドレスの加算を行える。  
また、名前の長さを0x18バイトにする事でサイズ用のポインタも一緒に名前として出力する事ができるので、heap領域のアドレスのリークが可能になる。  
以上の２つの脆弱性を使用することでアドレスのリークを行った後にfree_hookを書き換えて発火させる。  